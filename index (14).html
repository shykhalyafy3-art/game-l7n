<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>لعبة القفز</title>
<style>
  body {
    margin:0;
    overflow:hidden;
    background:#e0f7fa;
    font-family:Arial, sans-serif;
  }
  #game {
    position:relative;
    width:100%;
    height:300px;
    background:linear-gradient(#2196f3, #80deea);
  }
  #sky-text {
    position:absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-size:22px;
    font-weight:bold;
    color:white;
    text-shadow:0 0 5px #000;
  }
  #ground {
    position:absolute;
    bottom:0;
    width:100%;
    height:50px;
    background:#333;
  }
  #player {
    position:absolute;
    bottom:50px;
    left:50px;
    width:40px;
    height:40px;
    background:#ff5722;
    border-radius:6px;
  }
  #obstacle {
    position:absolute;
    bottom:50px;
    right:-60px;
    width:40px;
    height:40px;
    background:#4caf50;
  }
  #message {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    font-size:22px;
    font-weight:bold;
    color:#000;
    display:none;
    background:rgba(255,255,255,0.95);
    padding:15px 25px;
    border-radius:12px;
    text-align:center;
    line-height:1.6;
    max-width:90%;
  }
  @media (max-width:420px){
    #game{height:260px}
    #sky-text{font-size:18px}
    #message{font-size:18px;padding:12px 16px}
  }
</style>
</head>
<body>
  <div id="game">
    <div id="sky-text">اليافعي - L7N</div>
    <div id="player" aria-hidden="true"></div>
    <div id="obstacle" aria-hidden="true"></div>
    <div id="ground" aria-hidden="true"></div>
    <div id="message" role="alert">
      خسرت!<br>
      اضغط زر <span dir="ltr">Enter</span> (في الكيبورد)<br>
      أو المس الشاشة للإعادة
    </div>
  </div>

<script>
  const player = document.getElementById("player");
  const obstacle = document.getElementById("obstacle");
  const message = document.getElementById("message");

  let isJumping = false;
  let gameOver = false;
  let playerY = 50;
  let velocity = 0;
  const gravity = 0.7;
  const groundHeight = 50;

  // reset obstacle position on start
  obstacle.style.right = "-60px";

  function moveObstacle() {
    if (gameOver) return;
    let obstacleX = parseInt(obstacle.style.right) || 0;
    obstacleX += 5;
    if (obstacleX > window.innerWidth + 60) {
      obstacleX = -60;
    }
    obstacle.style.right = obstacleX + "px";

    const playerRect = player.getBoundingClientRect();
    const obstacleRect = obstacle.getBoundingClientRect();
    if (
      playerRect.right > obstacleRect.left &&
      playerRect.left < obstacleRect.right &&
      playerRect.bottom > obstacleRect.top
    ) {
      gameOver = true;
      message.style.display = "block";
    }
    requestAnimationFrame(moveObstacle);
  }

  function jump() {
    if (!isJumping && !gameOver) {
      isJumping = true;
      velocity = 12;
    }
  }

  function updatePlayer() {
    if (isJumping) {
      playerY += velocity;
      velocity -= gravity;
      if (playerY <= groundHeight) {
        playerY = groundHeight;
        isJumping = false;
      }
      player.style.bottom = playerY + "px";
    }
    requestAnimationFrame(updatePlayer);
  }

  function restartGame() {
    gameOver = false;
    message.style.display = "none";
    obstacle.style.right = "-60px";
    playerY = groundHeight;
    velocity = 0;
    player.style.bottom = groundHeight + "px";
    // small delay to avoid instant collision on restart
    setTimeout(() => {
      if (!gameOver) moveObstacle();
    }, 100);
  }

  // keyboard controls
  document.addEventListener("keydown", e => {
    if (e.code === "Space" || e.code === "ArrowUp") {
      e.preventDefault();
      jump();
    }
    if (e.code === "Enter" && gameOver) restartGame();
  });

  // touch controls (mobile)
  document.addEventListener("touchstart", (e) => {
    e.preventDefault();
    if (gameOver) restartGame();
    else jump();
  }, {passive:false});

  // allow click as well (desktop touchpads)
  document.addEventListener("mousedown", (e) => {
    if (gameOver) restartGame();
    else jump();
  });

  // start
  moveObstacle();
  updatePlayer();
</script>
</body>
</html>
